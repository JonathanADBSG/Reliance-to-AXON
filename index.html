<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reliance to AXON converter</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Inter", sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to top for better content flow */
            min-height: 100vh;
            padding: 2rem;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            text-align: center;
            border: 1px solid #e2e8f0; /* Subtle border */
        }
        .header-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .header-logo img {
            height: 60px; /* Adjust logo size */
            width: auto;
            border-radius: 0.5rem;
        }
        .module-box {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 1.25rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }
        .module-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            color: #2c5282; /* Darker blue for titles */
            margin-bottom: 1rem;
        }
        input[type="text"] {
            border: 2px solid #cbd5e1; /* Light gray border */
            border-radius: 0.75rem; /* Rounded input fields */
            padding: 0.75rem 1rem;
            width: 100%;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #3b82f6; /* Blue focus border */
        }
        button {
            background-color: #3b82f6; /* Blue button */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: background-color 0.2s, transform 0.1s;
            box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
        }
        button:hover {
            background-color: #2563eb; /* Darker blue on hover */
            transform: translateY(-2px); /* Slight lift effect */
        }
        button:active {
            transform: translateY(0);
            box-shadow: none;
        }
        .output-box, .notes-box, .error-box {
            background-color: #f8fafc; /* Lighter background for output/notes */
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: left;
            word-break: break-all; /* Ensure long part numbers wrap */
        }
        .error-box {
            background-color: #fee2e2; /* Light red for errors */
            border-color: #ef4444; /* Red border */
            color: #dc2626; /* Darker red text */
        }
        .notes-box {
            background-color: #fffbeb; /* Light yellow for notes */
            border-color: #f59e0b; /* Orange border */
            color: #d97706; /* Darker orange text */
        }
        .notes-box ul {
            list-style-type: disc;
            margin-left: 1.25rem;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container space-y-8">
        <div class="header-logo">
            <!-- ADB SAFEGATE Logo -->
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3a/ADB_Safegate_logo.jpg" alt="ADB SAFEGATE Logo">
            <h1 class="text-4xl font-extrabold text-gray-900">Reliance to AXON converter</h1>
        </div>
        <p class="text-gray-700 mb-8">Select the EREL product type below to convert its part number to the equivalent AXON part number. Please note the conversion relies on specific mapping rules and may not be 100% equivalent for all features due to differences in product lines.</p>

        <!-- EREL RUNWAY EDGE Module -->
        <div class="module-box">
            <h2 class="text-2xl font-bold module-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2v20M2 12h20M7 7l10 10M7 17l10-10"/>
                </svg>
                EREL RUNWAY EDGE (to AXON)
            </h2>
            <p class="text-gray-600 mb-6">Converts EREL Runway Edge part numbers into AXON part numbers.</p>
            <div class="flex flex-col sm:flex-row gap-4 mb-6">
                <input type="text" id="erelInputEdge" placeholder="Enter EREL Part Number (e.g., EREL6WW39M00112)" class="flex-grow">
                <button onclick="convertErelRunwayEdge()" class="w-full sm:w-auto">Convert</button>
            </div>

            <div id="errorOutputEdge" class="error-box hidden mb-4"></div>

            <div class="output-box mb-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">AXON Part Number:</h3>
                <p id="axonOutputEdge" class="text-lg font-mono text-gray-700">No conversion yet.</p>
            </div>

            <div id="notesContainerEdge" class="notes-box hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Conversion Notes:</h3>
                <ul id="notesListEdge" class="text-sm text-gray-700"></ul>
            </div>
        </div>

        <!-- EREL RUNWAY THRESHOLD, END ICAO Module -->
        <div class="module-box">
            <h2 class="text-2xl font-bold module-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2v20M2 12h20M7 7l10 10M7 17l10-10"/>
                </svg>
                EREL RUNWAY THRESHOLD, END ICAO (to AXON)
            </h2>
            <p class="text-gray-600 mb-6">Converts EREL Runway Threshold/End ICAO part numbers into AXON part numbers.</p>
            <div class="flex flex-col sm:flex-row gap-4 mb-6">
                <input type="text" id="erelInputThreshold" placeholder="Enter EREL Part Number (e.g., EREL6RN09M00112)" class="flex-grow">
                <button onclick="convertErelRunwayThresholdEndIcao()" class="w-full sm:w-auto">Convert</button>
            </div>

            <div id="errorOutputThreshold" class="error-box hidden mb-4"></div>

            <div class="output-box mb-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">AXON Part Number:</h3>
                <p id="axonOutputThreshold" class="text-lg font-mono text-gray-700">No conversion yet.</p>
            </div>

            <div id="notesContainerThreshold" class="notes-box hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Conversion Notes:</h3>
                <ul id="notesListThreshold" class="text-sm text-gray-700"></ul>
            </div>
        </div>

        <!-- EREL RUNWAY THRESHOLD, END FAA Module -->
        <div class="module-box">
            <h2 class="text-2xl font-bold module-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2v20M2 12h20M7 7l10 10M7 17l10-10"/>
                </svg>
                EREL RUNWAY THRESHOLD, END FAA (to AXON)
            </h2>
            <p class="text-gray-600 mb-6">Converts EREL Runway Threshold/End FAA part numbers into AXON part numbers.</p>
            <div class="flex flex-col sm:flex-row gap-4 mb-6">
                <input type="text" id="erelInputFaa" placeholder="Enter EREL Part Number (e.g., EREL2RF21SF0002)" class="flex-grow">
                <button onclick="convertErelRunwayThresholdEndFaa()" class="w-full sm:w-auto">Convert</button>
            </div>

            <div id="errorOutputFaa" class="error-box hidden mb-4"></div>

            <div class="output-box mb-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">AXON Part Number:</h3>
                <p id="axonOutputFaa" class="text-lg font-mono text-gray-700">No conversion yet.</p>
            </div>

            <div id="notesContainerFaa" class="notes-box hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Conversion Notes:</h3>
                <ul id="notesListFaa" class="text-sm text-gray-700"></ul>
            </div>
        </div>

        <!-- LEAP Approach Module -->
        <div class="module-box">
            <h2 class="text-2xl font-bold module-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-compass"><circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/></svg>
                LEAP Approach (to AXON)
            </h2>
            <p class="text-gray-600 mb-6">Converts LEAP Approach part numbers to AXON equivalent.</p>
            <div class="flex flex-col sm:flex-row gap-4 mb-6">
                <input type="text" id="leapInput" placeholder="Enter LEAP Part Number (e.g., EAPS2WN00MI0012)" class="flex-grow">
                <button onclick="convertLeapApproach()" class="w-full sm:w-auto">Convert</button>
            </div>

            <div id="errorOutputLeap" class="error-box hidden mb-4"></div>

            <div class="output-box mb-4">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">AXON Part Number:</h3>
                <p id="axonOutputLeap" class="text-lg font-mono text-gray-700">No conversion yet.</p>
            </div>

            <div id="notesContainerLeap" class="notes-box hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Conversion Notes:</h3>
                <ul id="notesListLeap" class="text-sm text-gray-700"></ul>
            </div>
        </div>

    </div>

    <script>
        // Function for EREL RUNWAY EDGE conversion
        function convertErelRunwayEdge() {
            const erelInput = document.getElementById('erelInputEdge').value.trim().toUpperCase();
            const axonOutputElement = document.getElementById('axonOutputEdge');
            const errorOutputElement = document.getElementById('errorOutputEdge');
            const notesContainer = document.getElementById('notesContainerEdge');
            const notesList = document.getElementById('notesListEdge');

            // Clear previous outputs
            axonOutputElement.textContent = 'No conversion yet.';
            errorOutputElement.classList.add('hidden');
            errorOutputElement.textContent = '';
            notesContainer.classList.add('hidden');
            notesList.innerHTML = '';

            // Input Validation (Updated to accept ERES)
            if (!erelInput.startsWith('ERE') || erelInput.length !== 15) {
                errorOutputElement.textContent = 'Invalid EREL/ERES Part Number format. It must start with "ERE" or "ERES" and be 15 characters long (e.g., EREL2WY31S00002 or ERES2WY31S00002).';
                errorOutputElement.classList.remove('hidden');
                return;
            }

            const erel_segments = {
                "prefix_char_4": erelInput[3], // The 4th character (E or S)
                "cable_connectors": erelInput[4],
                "color_right": erelInput[5],
                "color_left": erelInput[6],
                "toe_in": erelInput[7],
                "height_coupling": erelInput[8],
                "power_supply": erelInput[9],
                "standard": erelInput[10],
                "options": erelInput[11],
                "arctic_kit": erelInput[12],
                "corrosion_resistance": erelInput[13], // Ignored for conversion
                "version": erelInput[14]          // Ignored for conversion
            };

            const axon_components = {
                "prefix": "A",
                "application_part1": "R",
                "application_part2": "E",
                "standards": "1",
                "market_specific": "0",
                "lens_type": "P", // Default
                "omni_directional": "1",
                "advanced_connectivity": "0",
                "refurbished": "0",
                "version_control": "1", // Fixed to 1 as per expected output

                "toe_in_axon": "",
                "color_side1": "",
                "color_side2": "",
                "power_supply_axon": "",
                "cable_connector_axon": "",
                "coupling": "",
                "fixture_height": "",
                "option2": "",
            };

            const notes = [];

            // Change 1: AXON 6th digit (Lens Type) based on EREL 4th digit
            if (erel_segments["prefix_char_4"] === "S") {
                axon_components["lens_type"] = "G";
            } else {
                axon_components["lens_type"] = "P";
            }

            // Change 2: AXON 7th digit (Toe-in) for Module 1
            const erelToeInVal = parseInt(erel_segments["toe_in"]);
            if (erelToeInVal === 1) {
                axon_components["toe_in_axon"] = "L";
            } else if (erelToeInVal === 2) {
                axon_components["toe_in_axon"] = "R";
            } else if (erelToeInVal === 3) {
                axon_components["toe_in_axon"] = "C";
            } else if (erelToeInVal === 0) {
                notes.push(`EREL Toe-in '0' (No toe-in) is not explicitly mapped for AXON. Using 'X'.`);
                axon_components["toe_in_axon"] = "X"; // Changed from blank to X
            } else {
                notes.push(`Invalid EREL Toe-in code: '${erel_segments["toe_in"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components["toe_in_axon"] = "X";
            }

            // AXON 8th digit (Color - Side 1 (Left)) - Change 3: G becomes F
            axon_components["color_side1"] = erel_segments["color_right"];
            if (erel_segments["color_right"] === "G") {
                axon_components["color_side1"] = "F"; // G becomes F
            } else if (!["W", "R", "Y", "N"].includes(erel_segments["color_right"])) {
                notes.push(`Invalid EREL Right Color code: '${erel_segments["color_right"]}'. Defaulting AXON Side 1 Color to None (N).`);
                axon_components["color_side1"] = "N";
            }

            // AXON 9th digit (Color - Side 2 (Right)) - Change 3: G becomes F
            axon_components["color_side2"] = erel_segments["color_left"];
            if (erel_segments["color_left"] === "G") {
                axon_components["color_side2"] = "F"; // G becomes F
            } else if (!["W", "R", "Y", "N"].includes(erel_segments["color_left"])) {
                notes.push(`Invalid EREL Left Color code: '${erel_segments["color_left"]}'. Defaulting AXON Side 2 Color to None (N).`);
                axon_components["color_side2"] = "N";
            }

            // AXON 11th digit (Power Supply)
            if (erel_segments["power_supply"] === "S" || erel_segments["power_supply"] === "M") {
                axon_components["power_supply_axon"] = erel_segments["power_supply"];
            } else {
                notes.push(`Invalid EREL Power Supply code: '${erel_segments["power_supply"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components["power_supply_axon"] = "X";
            }

            // AXON 12th digit (Cable & Connector)
            const erelCableVal = parseInt(erel_segments["cable_connectors"]);
            if (erelCableVal === 2) {
                axon_components["cable_connector_axon"] = "2";
            } else if (erelCableVal === 6) {
                axon_components["cable_connector_axon"] = "1";
            } else if (erelCableVal === 8) {
                notes.push(`EREL Cable & Connectors code '8' has no direct AXON equivalent. Manual review needed for equivalent AXON external connector. Using 'X'.`);
                axon_components["cable_connector_axon"] = "X";
            } else {
                notes.push(`Invalid EREL Cable & Connectors code: '${erel_segments["cable_connectors"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components["cable_connector_axon"] = "X";
            }

            // Change 4: AXON 13th digit (Fixture Height) based on EREL Digit 9
            const erelHeightCouplingDigit = parseInt(erel_segments["height_coupling"]);
            if ([1, 5, 9].includes(erelHeightCouplingDigit)) {
                axon_components["fixture_height"] = "C";
            } else if ([2, 6].includes(erelHeightCouplingDigit)) {
                axon_components["fixture_height"] = "D";
            } else if ([3, 7].includes(erelHeightCouplingDigit)) {
                axon_components["fixture_height"] = "E";
            } else {
                notes.push(`Invalid EREL Height/Coupling code: '${erel_segments["height_coupling"]}'. Cannot map to AXON Fixture Height. Using 'X'.`);
                axon_components["fixture_height"] = "X";
            }

            // AXON 14th digit (Coupling) - still uses the original map for coupling
            const height_coupling_map_coupling = {
                "1": "D", "2": "D", "3": "D",
                "5": "C", "6": "C", "7": "C",
                "9": "B"
            };
            axon_components["coupling"] = height_coupling_map_coupling[erelHeightCouplingDigit] || "X";
            if (axon_components["coupling"] === "X") {
                 notes.push(`Invalid EREL Height/Coupling code: '${erel_segments["height_coupling"]}'. Cannot map to AXON Coupling. Using 'X'.`);
            }


            // AXON 15th digit (Option 2)
            if (erel_segments["arctic_kit"] === "1") {
                axon_components["option2"] = "1";
            } else if (erel_segments["arctic_kit"] === "0") {
                axon_components["option2"] = "0";
            } else {
                notes.push(`Invalid EREL Arctic Kit code: '${erel_segments["arctic_kit"]}'. Cannot map to AXON Option 2. Using 'X'.`);
                axon_components["option2"] = "X";
            }

            // Enhanced Corrosion Resistance and Version are ignored for conversion.

            // Construct AXON Part Number based on the CONCATENATE formula order and expected output
            const axon_part_number = (
                axon_components["prefix"] +
                axon_components["application_part1"] +
                axon_components["application_part2"] +
                axon_components["standards"] +
                axon_components["market_specific"] +
                axon_components["lens_type"] +
                axon_components["toe_in_axon"] +
                axon_components["color_side1"] +
                axon_components["color_side2"] +
                axon_components["omni_directional"] +
                axon_components["power_supply_axon"] +
                axon_components["cable_connector_axon"] +
                axon_components["fixture_height"] +   // AXON Digit 13
                axon_components["coupling"] +       // AXON Digit 14
                axon_components["option2"] +
                axon_components["advanced_connectivity"] +
                axon_components["refurbished"] +
                axon_components["version_control"]
            );

            axonOutputElement.textContent = axon_part_number;

            if (notes.length > 0) {
                notesContainer.classList.remove('hidden');
                notes.forEach(note => {
                    const li = document.createElement('li');
                    li.textContent = note;
                    notesList.appendChild(li);
                });
            }
        }

        // Function for EREL RUNWAY THRESHOLD, END ICAO conversion
        function convertErelRunwayThresholdEndIcao() {
            const erelInput = document.getElementById('erelInputThreshold').value.trim().toUpperCase();
            const axonOutputElement = document.getElementById('axonOutputThreshold');
            const errorOutputElement = document.getElementById('errorOutputThreshold');
            const notesContainer = document.getElementById('notesContainerThreshold');
            const notesList = document.getElementById('notesListThreshold');

            // Clear previous outputs
            axonOutputElement.textContent = 'No conversion yet.';
            errorOutputElement.classList.add('hidden');
            errorOutputElement.textContent = '';
            notesContainer.classList.add('hidden');
            notesList.innerHTML = '';

            // Input Validation (Updated to accept ERES)
            if (!erelInput.startsWith('ERE') || erelInput.length !== 15) {
                errorOutputElement.textContent = 'Invalid EREL/ERES Part Number format. It must start with "ERE" or "ERES" and be 15 characters long (e.g., EREL6RN09M00112).';
                errorOutputElement.classList.remove('hidden');
                return;
            }

            // Extract EREL segments based on NEW deconstruction for Threshold module
            const erel_segments_threshold = {
                "prefix_char_4": erelInput[3], // The 4th character (E or S)
                "cable_connectors": erelInput[4],
                "colors_combined_raw": erelInput.substring(5, 7), // Raw 6th and 7th combined
                "toe_in": erelInput[7],           // G71
                "height_coupling": erelInput[8],  // H71 (EREL Digit 9)
                "power_supply": erelInput[9],     // I71
                "standard": erelInput[10],        // J71
                "options": erelInput[11],         // K71
                "arctic_kit": erelInput[12],      // L71
                "corrosion_resistance": erelInput[13], // M71 (ignored)
                "version": erelInput[14]          // N71 (ignored)
            };

            // AXON part number components (corresponding to D111 to T111)
            const axon_components_threshold = {
                "prefix": "A", // Digit 1 (Fixed)
                "application_axon": "", // Digits 2 & 3 (RT, RN, RW - derived from F71)
                "standards": "3", // Digit 4 (Fixed to 3)
                "market_specific": "0", // Digit 5 (Fixed to 0)
                "lens_type": "P", // Default
                "omni_directional": "0", // Digit 10 (Fixed to 0)
                "advanced_connectivity": "0", // Digit 16 (Fixed to 0)
                "refurbished": "0", // Digit 17 (Fixed to 0)
                "version_control": "1", // Digit 18 (Fixed to 1)

                // Values derived from EREL
                "toe_in_axon": "", // Digit 7
                "color_side1": "", // Digit 8 (derived from F71)
                "color_side2": "", // Digit 9 (derived from F71)
                "power_supply_axon": "", // Digit 11
                "cable_connector_axon": "", // Digit 12
                "coupling": "", // Digit 14
                "fixture_height": "", // Digit 13
                "option2": "", // Digit 15
            };

            const notes = [];

            // Change 1: AXON 6th digit (Lens Type) based on EREL 4th digit
            if (erel_segments_threshold["prefix_char_4"] === "S") {
                axon_components_threshold["lens_type"] = "G";
            } else {
                axon_components_threshold["lens_type"] = "P";
            }

            // Change for G to F conversion *before* combined color validation
            let color1_processed = erel_segments_threshold["colors_combined_raw"][0];
            let color2_processed = erel_segments_threshold["colors_combined_raw"][1];

            if (color1_processed === "G") {
                color1_processed = "F";
            }
            if (color2_processed === "G") {
                color2_processed = "F";
            }

            const colors_combined_processed = color1_processed + color2_processed;
            erel_segments_threshold["colors_combined"] = colors_combined_processed; // Update segment for consistency

            // AXON Application (Digits 2 & 3) - derived from F71 (colors_combined)
            // Added "RR" and "NR" as valid combined colors
            const validCombinedColors = ["RN", "FN", "FR", "RF", "RR", "NR"];
            if (erel_segments_threshold["colors_combined"] === "RN") {
                axon_components_threshold["application_axon"] = "RN";
            } else if (validCombinedColors.includes(erel_segments_threshold["colors_combined"])) {
                axon_components_threshold["application_axon"] = "RT";
            } else {
                notes.push(`Invalid EREL combined colors: '${erel_segments_threshold["colors_combined_raw"]}'. After G-to-F conversion, '${erel_segments_threshold["colors_combined"]}' is not a valid AXON Application. Using 'XX'.`);
                axon_components_threshold["application_axon"] = "XX";
            }

            // AXON Toe-in (Digit 7) - from G71
            const erelToeInVal = parseInt(erel_segments_threshold["toe_in"]);
            if (erelToeInVal === 0) {
                axon_components_threshold["toe_in_axon"] = "N";
            } else if (erelToeInVal === 1) {
                axon_components_threshold["toe_in_axon"] = "L";
            } else if (erelToeInVal === 2) {
                axon_components_threshold["toe_in_axon"] = "R";
            } else if (erelToeInVal === 3) { // EREL code 3 (Both sides) is not allowed for this module
                notes.push(`EREL Toe-in '3' (Both sides with toe-in) is not allowed for this module. AXON Toe-in is left blank. Verify input.`);
                axon_components_threshold["toe_in_axon"] = "X"; // Indicate error
            } else {
                notes.push(`Invalid EREL Toe-in code: '${erel_segments_threshold["toe_in"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components_threshold["toe_in_axon"] = "X";
            }

            // AXON Colors (Digits 8 & 9) - now use the processed colors
            axon_components_threshold["color_side1"] = color1_processed;
            axon_components_threshold["color_side2"] = color2_processed;


            // AXON Power Supply (Digit 11) - from I71
            if (erel_segments_threshold["power_supply"] === "S" || erel_segments_threshold["power_supply"] === "M") {
                axon_components_threshold["power_supply_axon"] = erel_segments_threshold["power_supply"];
            } else {
                notes.push(`Invalid EREL Power Supply code: '${erel_segments_threshold["power_supply"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components_threshold["power_supply_axon"] = "X";
            }

            // AXON Cable & Connector (Digit 12) - from E71
            const erelCableVal = parseInt(erel_segments_threshold["cable_connectors"]);
            if (erelCableVal === 6) {
                axon_components_threshold["cable_connector_axon"] = "1"; // Corresponds to $N$112 (value 1)
            } else if (erelCableVal === 2) {
                axon_components_threshold["cable_connector_axon"] = "2"; // Corresponds to $N$113 (value 2)
            } else {
                notes.push(`Invalid EREL Cable & Connectors code: '${erel_segments_threshold["cable_connectors"]}'. Expected '2' or '6'. Cannot map to AXON. Using 'X'.`);
                axon_components_threshold["cable_connector_axon"] = "X";
            }

            // Change 7: AXON Digit 13 (Fixture Height) for Module 2
            const erelHeightCouplingDigitThreshold = parseInt(erel_segments_threshold["height_coupling"]);
            if ([9, 5].includes(erelHeightCouplingDigitThreshold)) {
                axon_components_threshold["fixture_height"] = "C";
            } else if (erelHeightCouplingDigitThreshold === 6) {
                axon_components_threshold["fixture_height"] = "D";
            } else if (erelHeightCouplingDigitThreshold === 7) {
                axon_components_threshold["fixture_height"] = "E";
            } else {
                notes.push(`Invalid EREL Height/Coupling code: '${erel_segments_threshold["height_coupling"]}'. Cannot map to AXON Fixture Height. Using 'X'.`);
                axon_components_threshold["fixture_height"] = "X";
            }

            // Change 5: AXON Digit 14 (Coupling) for Module 2
            if ([1, 2, 3].includes(erelHeightCouplingDigitThreshold)) {
                axon_components_threshold["coupling"] = "D";
            } else if ([5, 6, 7].includes(erelHeightCouplingDigitThreshold)) {
                axon_components_threshold["coupling"] = "C";
            } else if (erelHeightCouplingDigitThreshold === 9) {
                axon_components_threshold["coupling"] = "B";
            } else {
                notes.push(`Invalid EREL Height/Coupling code: '${erel_segments_threshold["height_coupling"]}'. Cannot map to AXON Coupling. Using 'X'.`);
                axon_components_threshold["coupling"] = "X";
            }


            // AXON Option 2 (Digit 15) - from L71 (Arctic Kit)
            if (erel_segments_threshold["arctic_kit"] === "1") {
                axon_components_threshold["option2"] = "1";
            } else if (erel_segments_threshold["arctic_kit"] === "0") {
                axon_components_threshold["option2"] = "0";
            } else {
                notes.push(`Invalid EREL Arctic Kit code: '${erel_segments_threshold["arctic_kit"]}'. Cannot map to AXON Option 2. Using 'X'.`);
                axon_components_threshold["option2"] = "X";
            }

            // Enhanced Corrosion Resistance and Version are ignored for conversion.

            // Construct AXON Part Number based on the CONCATENATE formula order
            const axon_part_number = (
                axon_components_threshold["prefix"] +
                axon_components_threshold["application_axon"] +
                axon_components_threshold["standards"] +
                axon_components_threshold["market_specific"] +
                axon_components_threshold["lens_type"] +
                axon_components_threshold["toe_in_axon"] +
                axon_components_threshold["color_side1"] +
                axon_components_threshold["color_side2"] +
                axon_components_threshold["omni_directional"] +
                axon_components_threshold["power_supply_axon"] +
                axon_components_threshold["cable_connector_axon"] +
                axon_components_threshold["fixture_height"] +   // Digit 13
                axon_components_threshold["coupling"] +         // Digit 14
                axon_components_threshold["option2"] +
                axon_components_threshold["advanced_connectivity"] +
                axon_components_threshold["refurbished"] +
                axon_components_threshold["version_control"]
            );

            axonOutputElement.textContent = axon_part_number;

            if (notes.length > 0) {
                notesContainer.classList.remove('hidden');
                notes.forEach(note => {
                    const li = document.createElement('li');
                    li.textContent = note;
                    notesList.appendChild(li);
                });
            }
        }

        // Function for EREL RUNWAY THRESHOLD, END FAA conversion
        function convertErelRunwayThresholdEndFaa() {
            const erelInput = document.getElementById('erelInputFaa').value.trim().toUpperCase();
            const axonOutputElement = document.getElementById('axonOutputFaa');
            const errorOutputElement = document.getElementById('errorOutputFaa');
            const notesContainer = document.getElementById('notesContainerFaa');
            const notesList = document.getElementById('notesListFaa');

            // Clear previous outputs
            axonOutputElement.textContent = 'No conversion yet.';
            errorOutputElement.classList.add('hidden');
            errorOutputElement.textContent = '';
            notesContainer.classList.add('hidden');
            notesList.innerHTML = '';

            // Input Validation (Updated to accept ERES)
            if (!erelInput.startsWith('ERE') || erelInput.length !== 15) {
                errorOutputElement.textContent = 'Invalid EREL/ERES Part Number format. It must start with "ERE" or "ERES" and be 15 characters long.';
                errorOutputElement.classList.remove('hidden');
                return;
            }

            // Extract EREL segments (same deconstruction as ICAO Threshold module)
            const erel_segments_faa = {
                "prefix_char_4": erelInput[3], // The 4th character (E or S)
                "cable_connectors": erelInput[4],
                "colors_combined_raw": erelInput.substring(5, 7), // Raw 6th and 7th combined
                "toe_in": erelInput[7],           // 8th digit
                "height_coupling": erelInput[8],  // 9th digit (EREL Digit 9)
                "power_supply": erelInput[9],     // 10th digit
                "standard": erelInput[10],        // 11th digit
                "options": erelInput[11],         // 12th digit
                "arctic_kit": erelInput[12],      // 13th digit
                "corrosion_resistance": erelInput[13], // 14th digit (ignored)
                "version": erelInput[14]          // 15th digit (ignored)
            };

            // AXON part number components (new fixed values for FAA module)
            const axon_components_faa = {
                "prefix": "A", // Digit 1 (Fixed)
                "application_axon": "", // Digits 2 & 3 (derived)
                "standards": "2", // Digit 4 (Fixed to 2, specific for FAA)
                "market_specific": "0", // Digit 5 (Fixed to 0)
                "lens_type": "P", // Default
                "omni_directional": "0", // Digit 10 (Fixed to 0)
                "advanced_connectivity": "0", // Digit 16 (Fixed to 0)
                "refurbished": "0", // Digit 17 (Fixed to 0)
                "version_control": "1", // Digit 18 (Fixed to 1)

                // Values derived from EREL
                "toe_in_axon": "", // Digit 7
                "color_side1": "", // Digit 8
                "color_side2": "", // Digit 9
                "power_supply_axon": "", // Digit 11
                "cable_connector_axon": "1", // Digit 12 (Fixed to 1, as EREL E5 can only be 2)
                "fixture_height": "", // Digit 13 (derived)
                "coupling": "", // Digit 14 (derived)
                "option2": "", // Digit 15
            };

            const notes = [];

            // Change 1: AXON 6th digit (Lens Type) based on EREL 4th digit
            if (erel_segments_faa["prefix_char_4"] === "S") {
                axon_components_faa["lens_type"] = "G";
            } else {
                axon_components_faa["lens_type"] = "P";
            }

            // Change for G to F conversion *before* combined color validation
            let color1_processed = erel_segments_faa["colors_combined_raw"][0];
            let color2_processed = erel_segments_faa["colors_combined_raw"][1];

            if (color1_processed === "G") {
                color1_processed = "F";
            }
            if (color2_processed === "G") {
                color2_processed = "F";
            }

            const colors_combined_processed = color1_processed + color2_processed;
            erel_segments_faa["colors_combined"] = colors_combined_processed; // Update segment for consistency

            // AXON Application (Digits 2 & 3) - derived from F71 (colors_combined)
            // Added "RR" and "NR" as valid combined colors
            const validCombinedColors = ["RN", "FN", "FR", "RF", "RR", "NR"];
            if (erel_segments_faa["colors_combined"] === "RN") {
                axon_components_faa["application_axon"] = "RN";
            } else if (validCombinedColors.includes(erel_segments_faa["colors_combined"])) {
                axon_components_faa["application_axon"] = "RT";
            } else {
                notes.push(`Invalid EREL combined colors: '${erel_segments_faa["colors_combined_raw"]}'. After G-to-F conversion, '${erel_segments_faa["colors_combined"]}' is not a valid AXON Application. Using 'XX'.`);
                axon_components_faa["application_axon"] = "XX";
            }

            // AXON Toe-in (Digit 7) - from G71
            const erelToeInVal = parseInt(erel_segments_faa["toe_in"]);
            if (erelToeInVal === 0) {
                axon_components_faa["toe_in_axon"] = "N";
            } else if (erelToeInVal === 1) {
                axon_components_faa["toe_in_axon"] = "L";
            } else if (erelToeInVal === 2) {
                axon_components_faa["toe_in_axon"] = "R";
            } else if (erelToeInVal === 3) { // EREL code 3 (Both sides) is not allowed for this module
                notes.push(`EREL Toe-in '3' (Both sides with toe-in) is not allowed for this module. AXON Toe-in is left blank. Verify input.`);
                axon_components_faa["toe_in_axon"] = "X"; // Indicate error
            } else {
                notes.push(`Invalid EREL Toe-in code: '${erel_segments_faa["toe_in"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components_faa["toe_in_axon"] = "X";
            }

            // AXON Colors (Digits 8 & 9) - now use the processed colors
            axon_components_faa["color_side1"] = color1_processed;
            axon_components_faa["color_side2"] = color2_processed;


            // AXON Power Supply (Digit 11) - from I71
            if (erel_segments_faa["power_supply"] === "S" || erel_segments_faa["power_supply"] === "M") {
                axon_components_faa["power_supply_axon"] = erel_segments_faa["power_supply"];
            } else {
                notes.push(`Invalid EREL Power Supply code: '${erel_segments_faa["power_supply"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components_faa["power_supply_axon"] = "X";
            }

            // AXON Cable & Connector (Digit 12) - FIXED to '1'
            if (erel_segments_faa["cable_connectors"] !== "2") {
                notes.push(`EREL Cable & Connectors code '${erel_segments_faa["cable_connectors"]}' is not '2' as expected for this FAA module. AXON Cable & Connector fixed to '1'. Verify input.`);
            }

            // Change 8: AXON Digit 13 (Fixture Height) for Module 3
            const erelHeightCouplingDigitFaa = parseInt(erel_segments_faa["height_coupling"]);
            if ([1, 5].includes(erelHeightCouplingDigitFaa)) {
                axon_components_faa["fixture_height"] = "C";
            } else if ([2, 6].includes(erelHeightCouplingDigitFaa)) {
                axon_components_faa["fixture_height"] = "D";
            } else if ([3, 7].includes(erelHeightCouplingDigitFaa)) {
                axon_components_faa["fixture_height"] = "E";
            } else {
                notes.push(`Invalid EREL Height/Coupling code: '${erel_segments_faa["height_coupling"]}'. Cannot map to AXON Fixture Height. Using 'X'.`);
                axon_components_faa["fixture_height"] = "X";
            }

            // Change 9: AXON Digit 14 (Coupling) for Module 3
            if ([5, 6, 7].includes(erelHeightCouplingDigitFaa)) {
                axon_components_faa["coupling"] = "C";
            } else if ([1, 2, 3].includes(erelHeightCouplingDigitFaa)) {
                axon_components_faa["coupling"] = "D";
            } else {
                notes.push(`Invalid EREL Height/Coupling code: '${erel_segments_faa["height_coupling"]}'. Cannot map to AXON Coupling. Using 'X'.`);
                axon_components_faa["coupling"] = "X";
            }


            // AXON Option 2 (Digit 15) - from L71 (Arctic Kit)
            if (erel_segments_faa["arctic_kit"] === "1") {
                axon_components_faa["option2"] = "1";
            } else if (erel_segments_faa["arctic_kit"] === "0") {
                axon_components_faa["option2"] = "0";
            } else {
                notes.push(`Invalid EREL Arctic Kit code: '${erel_segments_faa["arctic_kit"]}'. Cannot map to AXON Option 2. Using 'X'.`);
                axon_components_faa["option2"] = "X";
            }

            // Enhanced Corrosion Resistance and Version are ignored for conversion.

            // Construct AXON Part Number
            const axon_part_number = (
                axon_components_faa["prefix"] +
                axon_components_faa["application_axon"] +
                axon_components_faa["standards"] +
                axon_components_faa["market_specific"] +
                axon_components_faa["lens_type"] +
                axon_components_faa["toe_in_axon"] +
                axon_components_faa["color_side1"] +
                axon_components_faa["color_side2"] +
                axon_components_faa["omni_directional"] +
                axon_components_faa["power_supply_axon"] +
                axon_components_faa["cable_connector_axon"] + // Fixed to '1'
                axon_components_faa["fixture_height"] +   // Derived
                axon_components_faa["coupling"] +         // Derived
                axon_components_faa["option2"] +
                axon_components_faa["advanced_connectivity"] +
                axon_components_faa["refurbished"] +
                axon_components_faa["version_control"]
            );

            axonOutputElement.textContent = axon_part_number;

            if (notes.length > 0) {
                notesContainer.classList.remove('hidden');
                notes.forEach(note => {
                    const li = document.createElement('li');
                    li.textContent = note;
                    notesList.appendChild(li);
                });
            }
        }

        // Function for LEAP Approach conversion
        function convertLeapApproach() {
            const leapInput = document.getElementById('leapInput').value.trim().toUpperCase();
            const axonOutputElement = document.getElementById('axonOutputLeap');
            const errorOutputElement = document.getElementById('errorOutputLeap');
            const notesContainer = document.getElementById('notesContainerLeap');
            const notesList = document.getElementById('notesListLeap');

            // Clear previous outputs
            axonOutputElement.textContent = 'No conversion yet.';
            errorOutputElement.classList.add('hidden');
            errorOutputElement.textContent = '';
            notesContainer.classList.add('hidden');
            notesList.innerHTML = '';

            // Input Validation for LEAP
            if (!leapInput.startsWith('EAPS') || leapInput.length !== 15) {
                errorOutputElement.textContent = 'Invalid LEAP Part Number format. It must start with "EAPS" and be 15 characters long (e.g., EAPS2WN00MI0012).';
                errorOutputElement.classList.remove('hidden');
                return;
            }

            // Extract LEAP segments
            const leap_segments = {
                "leap_digit_5": leapInput[4],  // Char index 4
                "leap_digit_6": leapInput[5],  // Char index 5 (W or R)
                "leap_digit_7": leapInput[6],  // Char index 6
                "leap_digit_8": leapInput[7],  // Char index 7
                "leap_digit_9": leapInput[8],  // Char index 8
                "leap_digit_10": leapInput[9], // Char index 9 (S or M or I)
                "leap_digit_11": leapInput[10], // Char index 10
                "leap_digit_12": leapInput[11], // Char index 11
                "leap_digit_13": leapInput[12], // Char index 12
                "leap_digit_14": leapInput[13], // Char index 13
                "leap_digit_15": leapInput[14]  // Char index 14
            };

            // AXON part number components for LEAP
            const axon_components_leap = {
                "prefix": "A", // Digit 1 (Fixed)
                "application_axon": "", // Digits 2 & 3 (AC or AS)
                "standards": "3", // Digit 4 (Fixed to 3)
                "market_specific": "0", // Digit 5 (Fixed to 0)
                "lens_type": "P", // Digit 6 (Fixed to P)
                "toe_in_axon": "N", // Digit 7 (Fixed to N)
                "color_side1": "", // Digit 8 (W or R)
                "color_side2": "N", // Digit 9 (Fixed to N)
                "omni_directional": "0", // Digit 10 (Fixed to 0)
                "power_supply_axon": "", // Digit 11 (S or M)
                "cable_connector_axon": "2", // Digit 12 (Fixed to 2)
                "fixture_height": "A", // Digit 13 (Fixed to A)
                "coupling": "A", // Digit 14 (Fixed to A)
                "option2": "0", // Digit 15 (Fixed to 0)
                "advanced_connectivity": "0", // Digit 16 (Fixed to 0)
                "refurbished": "0", // Digit 17 (Fixed to 0)
                "version_control": "1" // Digit 18 (Fixed to 1)
            };

            const notes = [];

            // --- Conversion Logic for LEAP Approach ---

            // AXON Application (Digits 2 & 3)
            if (leap_segments["leap_digit_6"] === "W") {
                axon_components_leap["application_axon"] = "AC";
            } else if (leap_segments["leap_digit_6"] === "R") {
                axon_components_leap["application_axon"] = "AS";
            } else {
                notes.push(`Invalid LEAP Digit 6: '${leap_segments["leap_digit_6"]}'. Expected 'W' or 'R'. Cannot map to AXON Application. Using 'XX'.`);
                axon_components_leap["application_axon"] = "XX";
            }

            // AXON Color Side 1 (Digit 8)
            if (leap_segments["leap_digit_6"] === "W") {
                axon_components_leap["color_side1"] = "W";
            } else if (leap_segments["leap_digit_6"] === "R") {
                axon_components_leap["color_side1"] = "R";
            } else {
                notes.push(`Invalid LEAP Digit 6: '${leap_segments["leap_digit_6"]}'. Expected 'W' or 'R'. Cannot map to AXON Color Side 1. Using 'X'.`);
                axon_components_leap["color_side1"] = "X";
            }

            // AXON Power Supply (Digit 11) - same as LEAP Digit 10
            if (leap_segments["leap_digit_10"] === "S" || leap_segments["leap_digit_10"] === "M") {
                axon_components_leap["power_supply_axon"] = leap_segments["leap_digit_10"];
            } else if (leap_segments["leap_digit_10"] === "I") { // Example showed 'I', assume it maps to 'S' (non-monitored)
                axon_components_leap["power_supply_axon"] = "S";
                notes.push(`LEAP Power Supply 'I' mapped to AXON 'S' (No monitoring). Confirm this is the desired mapping.`);
            }
            else {
                notes.push(`Invalid LEAP Digit 10 (Power Supply): '${leap_segments["leap_digit_10"]}'. Cannot map to AXON. Using 'X'.`);
                axon_components_leap["power_supply_axon"] = "X";
            }

            // Construct AXON Part Number
            const axon_part_number = (
                axon_components_leap["prefix"] +
                axon_components_leap["application_axon"] +
                axon_components_leap["standards"] +
                axon_components_leap["market_specific"] +
                axon_components_leap["lens_type"] +
                axon_components_leap["toe_in_axon"] +
                axon_components_leap["color_side1"] +
                axon_components_leap["color_side2"] +
                axon_components_leap["omni_directional"] +
                axon_components_leap["power_supply_axon"] +
                axon_components_leap["cable_connector_axon"] +
                axon_components_leap["fixture_height"] +
                axon_components_leap["coupling"] +
                axon_components_leap["option2"] +
                axon_components_leap["advanced_connectivity"] +
                axon_components_leap["refurbished"] +
                axon_components_leap["version_control"]
            );

            axonOutputElement.textContent = axon_part_number;

            if (notes.length > 0) {
                notesContainer.classList.remove('hidden');
                notes.forEach(note => {
                    const li = document.createElement('li');
                    li.textContent = note;
                    notesList.appendChild(li);
                });
            }
        }
    </script>
</body>
</html>
